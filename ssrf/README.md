# SSRF - Server Side Request Forgery

## Описание

SSRF - уязвимость, позволяющая злоумышленнику спровоцировать сервер на отправку произвольных запросов от своего имени. Благодаря этому злоумышленник может отправлять запросы во внутреннюю сеть или подсеть, просканировать порты и саму сеть. Данная уязвимость появляется при возможности редактировании пользователем URL-адреса, при этом сервер делает запрос во внутреннюю сеть. Так же злоумышленник с помощью SSRF может выполнять произвольные HTTP GET-запросы. Можно получить доступ к различным закрытым путям или облачным API.



## Условия

- уязвимость можно осуществить на любой операционной системе;
- для осуществления необходим сервер со связью с интернетом; 

## Детектирование

Способ 1: поиск URL в пользовательском вводе.
С помощью Burp Suit смотрим запрос. Можно увидеть, что парсится вся страница яндекса.
![Image alt](https://github.com/lifeskipp/shift2019/raw/master/ssrf/images/1_pars.png)

Из этого можно сделать вывод, что мы можем подставить туда произвольный запрос, например, обратиться к локал хосту. 

Способ 2: Burp Suite Collaborator

С помощью сервера колаборатора можно убедится в том, что запросы проходят по удалённому веб-серверу.
![Image alt](https://github.com/lifeskipp/shift2019/raw/master/ssrf/images/2_collab.png)
Это подтверждает наличие уязвимости.

## Эксплуатация

разделить по импакту
 
- Обращение к локалхосту
```
http://127.0.0.1/
http://0.0.0.0/
http://localhost/
```
Обращение делаем с помощью Burp Suite
скан сети
облачные API

Существует несколько схем осуществления атаки:
- HTTP/HTTPS - внедрение произвольных GET запросов;
- GOPHER - произвольные TCP пакеты;
- TFDP - произвольные UDP диаграммы;
- File - обращение к диску.	

### Инструменты

- Burp Suite  - с его помощью можем менять URL, который отправляет сервер, тем самым попадаем в локалхост.

## Ущерб


## Защита
### Основные меры

- Проверять схему в ссылке и работать только с HTTP/HTTPS
- Проверять адрес в ссылке и блокировать запросы на внутренние подсети
(192.168.0.0/16, 172.16.0.0/12, 10.0.0.0/8, 127.0.0.0/8 и т.д.)
НО от данной атаки на 100% защититься нельзя.

### Превентивные меры
Вынести сервер, обрабатыващий URL в отдельный сегмент сети


## Дополнительно
Здесь приложить дополнительную информацию и источники, которые использовали, но не указали выше в других местах.

## Обход защиты
- Сокращения
```
http://127.1/
http://0/
```
- Представление не в десятичной форме
```
http://0177.1/
http://0x7f.1/
http://2130706433/
```
