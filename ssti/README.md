# уязвимость/атака
SSTI

## Описание
Возникает из-за неверной обработки пользовательских данных. В отличии от XSS (с которой SSTI очень легко спутать), Template Injection(внедрение шаблона) можно использовать для получения удаленного выполнения команд (RCE).

## Классификация
Классифицируются по шаблонизаторам: Smarty, Mako, Twig, and Jinja2.

## Условия
- ОС: -
- язык: -
- компоненты: шаблонизатор
- настройки: -

## Детектирование
Обнаружение 2 способами:
- Первый способ: пользовательский ввод помещается в шаблонное выражение.
- Второй способ: пользовательский ввод может быть помещён внутри шаблонного выражения, как правило, в качестве имени переменной.
Идентификация:
Выяснить, какой шаблонизатор используется. Сделать это очень просто, так как есть готовая схема для этой цели. Этот процесс выглядит так:
![](https://defcon.ru/wp-content/uploads/2016/11/1.png)

## Эксплуатация(?)
Здесь необходимо описать пример ручной эксплуатации. Сразу уточните какой это язык, какие компоненты используются, если эксплуатация специфична только для этих условий. Можно записать сюда порядок действий при эксплуатации тестового задания

### Инструменты
Tplmap. [Информация](https://github.com/epinna/tplmap)

## Ущерб
Захват прав суперпользователя.

## Защита(?)
### Основные меры
В основных мерах описываем способы как 100% защититься от уязвимости/атаки

### Превентивные меры(?)
А здесь описываем как можем уменьшить ущерб от уязвимости/атаки, если она существует. То есть, подход Defense in Depth.

## Дополнительно(?)
Здесь приложить дополнительную информацию и источники, которые использовали, но не указали выше в других местах.

## Обход защиты(?)
Если существуют варианты обхода защиты, то можно их здесь перечислить.

Если есть возможность, то надо написать в чем заключается защита и каким образом она обходится.
